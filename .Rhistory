data = volumes_thickness)
thickness_table <- tableby(SCD ~ lh_parahippocampal_thickness +
rh_parahippocampal_thickness +
lh_entorhinal_thickness + rh_entorhinal_thickness +
lh_temporalpole_thickness + rh_temporalpole_thickness +
lh_inferiortemporal_thickness + rh_inferiortemporal_thickness +
lh_middletemporal_thickness + rh_middletemporal_thickness +
lh_inferiorparietal_thickness + rh_inferiorparietal_thickness +
lh_superiorparietal_thickness + rh_superiorparietal_thickness +
lh_precuneus_thickness + rh_precuneus_thickness +
lh_posteriorcingulate_thickness + rh_posteriorcingulate_thickness,
data = volumes_thickness, numeric.stats = c("N", "meansd", "range"), total = FALSE)
summary(thickness_table, text = TRUE)
#prepare table
volumes_thickness$SCD <- factor(volumes_thickness$SCD,
levels = c(1, 0),
labels = c('SCD', 'Control'))
attr(volumes_thickness$SCD, 'label') <- 'Subjective Cognitive Decline'
attr(volumes_thickness$lh_parahippocampal_thickness)
results <- "asis"
thickness_table <- tableby(SCD ~ lh_parahippocampal_thickness +
rh_parahippocampal_thickness +
lh_entorhinal_thickness + rh_entorhinal_thickness +
lh_temporalpole_thickness + rh_temporalpole_thickness +
lh_inferiortemporal_thickness + rh_inferiortemporal_thickness +
lh_middletemporal_thickness + rh_middletemporal_thickness +
lh_inferiorparietal_thickness + rh_inferiorparietal_thickness +
lh_superiorparietal_thickness + rh_superiorparietal_thickness +
lh_precuneus_thickness + rh_precuneus_thickness +
lh_posteriorcingulate_thickness + rh_posteriorcingulate_thickness,
data = volumes_thickness, numeric.stats = c("N", "meansd", "range"), total = FALSE)
summary(thickness_table, text = TRUE)
thickness_table <- tableby(SCD ~ lh_parahippocampal_thickness +
rh_parahippocampal_thickness +
lh_entorhinal_thickness + rh_entorhinal_thickness +
lh_temporalpole_thickness + rh_temporalpole_thickness +
lh_inferiortemporal_thickness + rh_inferiortemporal_thickness +
lh_middletemporal_thickness + rh_middletemporal_thickness +
lh_inferiorparietal_thickness + rh_inferiorparietal_thickness +
lh_superiorparietal_thickness + rh_superiorparietal_thickness +
lh_precuneus_thickness + rh_precuneus_thickness +
lh_posteriorcingulate_thickness + rh_posteriorcingulate_thickness,
data = volumes_thickness, total = FALSE)
summary(thickness_table, text = TRUE)
write2word(thickness_table, "thickness_table.docx")
?rename_with
thickness <- left_join(anat_over_55, lh_aparc) %>% left_join(., rh_aparc) %>%
drop_na() %>%
select(participant_id, contains("parahippocampal"), contains("entorhinal"),
contains("temporalpole"), contains("inferiortemporal"), contains("middletemporal"),
contains("inferiorparietal"), contains("middletemporal"), contains("inferiorparietal"),
contains("superiorparietal"), contains("precuneus"), contains("posteriorcingulate")) %>%
rename_with(~ str_remove(., "_thickness"))
View(thickness)
volumes_thickness <- left_join(thickness, volumes)
#prepare table
volumes_thickness$SCD <- factor(volumes_thickness$SCD,
levels = c(1, 0),
labels = c('SCD', 'Control'))
attr(volumes_thickness$lh_parahippocampal_thickness)
results <- "asis"
thickness_table <- tableby(SCD ~ lh_parahippocampal_thickness +
rh_parahippocampal_thickness +
lh_entorhinal_thickness + rh_entorhinal_thickness +
lh_temporalpole_thickness + rh_temporalpole_thickness +
lh_inferiortemporal_thickness + rh_inferiortemporal_thickness +
lh_middletemporal_thickness + rh_middletemporal_thickness +
lh_inferiorparietal_thickness + rh_inferiorparietal_thickness +
lh_superiorparietal_thickness + rh_superiorparietal_thickness +
lh_precuneus_thickness + rh_precuneus_thickness +
lh_posteriorcingulate_thickness + rh_posteriorcingulate_thickness,
data = volumes_thickness, total = FALSE)
summary(thickness_table, text = TRUE)
write2word(thickness_table, "thickness_table.docx")
thickness <- left_join(anat_over_55, lh_aparc) %>% left_join(., rh_aparc) %>%
drop_na() %>%
select(participant_id, contains("parahippocampal"), contains("entorhinal"),
contains("temporalpole"), contains("inferiortemporal"), contains("middletemporal"),
contains("inferiorparietal"), contains("middletemporal"), contains("inferiorparietal"),
contains("superiorparietal"), contains("precuneus"), contains("posteriorcingulate")) %>%
rename_with(~ str_remove(., "_thickness"))
volumes_thickness <- left_join(thickness, volumes)
View(volumes_thickness)
thickness_table <- tableby(SCD ~ lh_parahippocampal +
rh_parahippocampal +
lh_entorhinal + rh_entorhinal +
lh_temporalpole_thickness + rh_temporalpole +
lh_inferiortemporal + rh_inferiortemporal +
lh_middletemporal + rh_middletemporal +
lh_inferiorparietal + rh_inferiorparietal +
lh_superiorparietal + rh_superiorparietal +
lh_precuneus + rh_precuneus +
lh_posteriorcingulate + rh_posteriorcingulate,
data = volumes_thickness, total = FALSE)
thickness_table <- tableby(SCD ~ lh_parahippocampal +
rh_parahippocampal +
lh_entorhinal + rh_entorhinal +
lh_temporalpole + rh_temporalpole +
lh_inferiortemporal + rh_inferiortemporal +
lh_middletemporal + rh_middletemporal +
lh_inferiorparietal + rh_inferiorparietal +
lh_superiorparietal + rh_superiorparietal +
lh_precuneus + rh_precuneus +
lh_posteriorcingulate + rh_posteriorcingulate,
data = volumes_thickness, total = FALSE)
summary(thickness_table, text = TRUE)
write2word(thickness_table, "thickness_table.docx")
#prepare table
volumes_thickness$SCD <- factor(volumes_thickness$SCD,
levels = c(1, 0),
labels = c('SCD', 'Control'))
attr(volumes_thickness$lh_parahippocampal_thickness)
results <- "asis"
thickness_table <- tableby(SCD ~ lh_parahippocampal +
rh_parahippocampal +
lh_entorhinal + rh_entorhinal +
lh_temporalpole + rh_temporalpole +
lh_inferiortemporal + rh_inferiortemporal +
lh_middletemporal + rh_middletemporal +
lh_inferiorparietal + rh_inferiorparietal +
lh_superiorparietal + rh_superiorparietal +
lh_precuneus + rh_precuneus +
lh_posteriorcingulate + rh_posteriorcingulate,
data = volumes_thickness, total = FALSE)
summary(thickness_table, text = TRUE)
write2word(thickness_table, "thickness_table.docx")
volumes_table <- tableby(SCD ~ `left hippocampus` + `right hippocampus` +
`left cerebral white matter` + `right cerebral white matter`,
data = volumes_thickness, total = FALSE)
summary(volumes_table, text = TRUE)
write2word(volumes_table, "volumes_table.docx")
source("/Volumes/Research/lazarm03lab/labspace/AD/camcan995/derivatives/camcan_scd_dMRI_paper/2_demo_cog.R", echo=TRUE)
source("/Volumes/Research/lazarm03lab/labspace/AD/camcan995/derivatives/camcan_scd_dMRI_paper/2_demo_cog.R", echo=TRUE)
#run synthseg, recon-all-clinical, and aparcstats2table first
library(tidyverse)
library(arsenal)
aseg = read_csv("recon-all-clinical/asegtable.tsv") %>%
rename(participant_id=`Measure:volume`) %>%
# mutate(participant_id = str_remove(participant_id, "_T1w")) %>%
# distinct(participant_id, .keep_all = TRUE) %>%
mutate(across(c(2:ncol(.)), .fns = ~.*1000/EstimatedTotalIntraCranialVol)) #normalize by intracranial volume
aseg = read_csv("recon-all-clinical/asegtable.tsv") %>%
# rename(participant_id=`Measure:volume`) %>%
# mutate(participant_id = str_remove(participant_id, "_T1w")) %>%
# distinct(participant_id, .keep_all = TRUE) %>%
mutate(across(c(2:ncol(.)), .fns = ~.*1000/EstimatedTotalIntraCranialVol)) #normalize by intracranial volume
aseg = read_csv("recon-all-clinical/asegtable.tsv") #%>%
View(aseg)
aseg = read_tsv("recon-all-clinical/asegtable.tsv") #%>%
View(aseg)
aseg = read_tsv("recon-all-clinical/asegtable.tsv") %>%
rename(participant_id=`Measure:volume`) %>%
# mutate(participant_id = str_remove(participant_id, "_T1w")) %>%
# distinct(participant_id, .keep_all = TRUE) %>%
mutate(across(c(2:ncol(.)), .fns = ~.*1000/EstimatedTotalIntraCranialVol)) #normalize by intracranial volume
View(aseg)
aseg = read_tsv("recon-all-clinical/asegtable.tsv") %>%
rename(participant_id=`Measure:volume`) #%>%
View(aseg)
aseg = read_tsv("recon-all-clinical/asegtable.tsv") %>%
rename(participant_id=`Measure:volume`) %>%
# mutate(participant_id = str_remove(participant_id, "_T1w")) %>%
# distinct(participant_id, .keep_all = TRUE) %>%
mutate(across(c(2:ncol(.)), .fns = ~.*1000/EstimatedTotalIntraCranialVol)) #normalize by intracranial volume
View(aseg)
volumes <- left_join(anat_over_55, aseg) %>%
select(participant_id, SCD, contains("Hippocampus"), contains("CerebralWhiteMatter"))
aseg = read_tsv("recon-all-clinical/asegtable.tsv") %>%
rename(participant_id=`Measure:volume`) %>%
mutate(across(c(2:ncol(.)), .fns = ~.*1000/EstimatedTotalIntraCranialVol)) #normalize by intracranial volume
lh_aparc = read_tsv("recon-all-clinical/lh_aparctable.tsv") %>%
rename(participant_id=lh.aparc.thickness)
rh_aparc = read_tsv("recon-all-clinical/rh_aparctable.tsv") %>%
rename(participant_id=rh.aparc.thickness)
anat_over_55 = read.delim("anat_over_55.tsv", tryLogical = FALSE) %>%
select(participant_id, SCD)
volumes <- left_join(anat_over_55, aseg) %>%
select(participant_id, SCD, contains("Hippocampus"), contains("CerebralWhiteMatter"))
View(volumes)
volumes <- left_join(anat_over_55, aseg) %>%
select(participant_id, SCD, contains("Hippocampus"), contains("CerebralWhiteMatter")) %>%
drop_na()
wmparc = read_tsv("recon-all-clinical/wmparctable.tsv")
View(wmparc)
aseg = read_tsv("recon-all-clinical/asegtable.tsv") %>%
rename(participant_id=`Measure:volume`) #%>%
aseg = read_tsv("recon-all-clinical/asegtable.tsv") %>%
rename(participant_id=`Measure:volume`) %>%
mutate(across(c(2:ncol(.)), .fns = ~.*1000/EstimatedTotalIntraCranialVol)) #normalize by intracranial volume
lh_aparc = read_tsv("recon-all-clinical/lh_aparctable.tsv") %>%
rename(participant_id=lh.aparc.thickness)
rh_aparc = read_tsv("recon-all-clinical/rh_aparctable.tsv") %>%
rename(participant_id=rh.aparc.thickness)
wmparc = read_tsv("recon-all-clinical/wmparctable.tsv") %>%
rename(participant_id=`Measure:volume`) %>%
mutate(across(c(2:ncol(.)), .fns = ~.*1000/EstimatedTotalIntraCranialVol))
anat_over_55 = read.delim("anat_over_55.tsv", tryLogical = FALSE) %>%
select(participant_id, SCD)
volumes <- left_join(anat_over_55, aseg) %>%
select(participant_id, SCD, contains("Hippocampus")) %>%
left_join(., wmparc) %>%
select(participant_id, SCD, contains("Hippocampus"), contains("parahippo"),
contains("CerebralWhiteMatter"))
View(volumes)
colnames(volumes)
volumes_table <- tableby(SCD ~ `Left-Hippocampus` + `Right-Hippocampus` +
`wm-lh-parahippocampal` + `wm-rh-parahippocampal` +
lhCerebralWhiteMatterVol + rhCerebralWhiteMatterVol,
data = volumes_thickness, total = FALSE)
thickness <- left_join(anat_over_55, lh_aparc) %>% left_join(., rh_aparc) %>%
drop_na() %>%
select(participant_id, contains("parahippocampal"), contains("entorhinal"),
contains("temporalpole"), contains("inferiortemporal"), contains("middletemporal"),
contains("inferiorparietal"), contains("middletemporal"), contains("inferiorparietal"),
contains("superiorparietal"), contains("precuneus"), contains("posteriorcingulate")) %>%
rename_with(~ str_remove(., "_thickness"))
volumes <- left_join(anat_over_55, aseg) %>%
select(participant_id, SCD, contains("Hippocampus")) %>%
left_join(., wmparc) %>%
select(participant_id, SCD, contains("Hippocampus"), contains("parahippo"),
contains("CerebralWhiteMatter")) %>%
drop_na()
thickness <- left_join(anat_over_55, lh_aparc) %>% left_join(., rh_aparc) %>%
drop_na() %>%
select(participant_id, contains("parahippocampal"), contains("entorhinal"),
contains("temporalpole"), contains("inferiortemporal"), contains("middletemporal"),
contains("inferiorparietal"), contains("middletemporal"), contains("inferiorparietal"),
contains("superiorparietal"), contains("precuneus"), contains("posteriorcingulate")) %>%
rename_with(~ str_remove(., "_thickness"))
volumes_thickness <- left_join(thickness, volumes)
#prepare table
volumes_thickness$SCD <- factor(volumes_thickness$SCD,
levels = c(1, 0),
labels = c('SCD', 'Control'))
results <- "asis"
thickness_table <- tableby(SCD ~ lh_parahippocampal +
rh_parahippocampal +
lh_entorhinal + rh_entorhinal +
lh_temporalpole + rh_temporalpole +
lh_inferiortemporal + rh_inferiortemporal +
lh_middletemporal + rh_middletemporal +
lh_inferiorparietal + rh_inferiorparietal +
lh_superiorparietal + rh_superiorparietal +
lh_precuneus + rh_precuneus +
lh_posteriorcingulate + rh_posteriorcingulate,
data = volumes_thickness, total = FALSE)
summary(thickness_table, text = TRUE)
write2word(thickness_table, "thickness_table.docx")
volumes_table <- tableby(SCD ~ `Left-Hippocampus` + `Right-Hippocampus` +
`wm-lh-parahippocampal` + `wm-rh-parahippocampal` +
lhCerebralWhiteMatterVol + rhCerebralWhiteMatterVol,
data = volumes_thickness, total = FALSE)
summary(volumes_table, text = TRUE)
write2word(volumes_table, "volumes_table.docx")
View(anat_over_55)
library(tidyverse)
#replace with location for your source data from the CamCan data repository
data_dir = "/Volumes/Research/lazarm03lab/labspace/AD/camcan995/source_materials"
standard_data = read_csv(file.path(data_dir, "standard_data.csv"))
approved_data = read_tsv(file.path(data_dir, "behavioral/approved_data.tsv"))
#summary txt files had header and footer removed and were converted to tsv in a text editor
vstm = read_tsv(file.path(data_dir, "behavioral/VSTMcolour_summary.tsv")) %>%
rename_at(vars(-CCID), ~ paste0(., "_vstm"))
rtsimple = read_tsv(file.path(data_dir, "behavioral/RTsimple_summary.tsv")) %>%
rename_at(vars(-CCID), ~ paste0(., "_rtsimple"))
rtchoice = read_tsv(file.path(data_dir, "behavioral/RTchoice_summary.tsv")) %>%
rename_at(vars(-CCID), ~ paste0(., "_rtchoice"))
emotional_memory = read_tsv(file.path(data_dir, "behavioral/EmotionalMemory_summary.tsv")) %>%
rename_at(vars(-CCID), ~ paste0(., "_emotional_mem"))
cattell = read_tsv(file.path(data_dir, "behavioral/Cattell_summary.tsv")) %>%
rename_at(vars(-CCID), ~ paste0(., "_cattell"))
cardio_measures = read_tsv(file.path(data_dir, "behavioral/cardio_measures.tsv")) %>%
rename(CCID = Observations) %>%   rename_at(vars(-CCID), ~ paste0(., "_cardio"))
participants = full_join(standard_data, approved_data, by='CCID') %>%
left_join(., vstm, by='CCID') %>%
left_join(., rtsimple, by='CCID') %>% left_join(., rtchoice, by='CCID') %>%
left_join(., emotional_memory, by='CCID') %>% full_join(., cattell, by='CCID') %>%
left_join(., cardio_measures, by='CCID') %>%
mutate(CCID = str_replace(CCID, "CC", "sub-CC")) %>% rename(participant_id=CCID)
names(participants) <- tolower(names(participants))
write_tsv(participants, "/Volumes/Research/lazarm03lab/labspace/AD/camcan995/raw/participants.tsv")
#replace with location of your participants.tsv
participants = read.delim("/Volumes/Research/lazarm03lab/labspace/AD/camcan995/raw/participants.tsv", tryLogical = FALSE)
participants$SCD <- participants$homeint_v230
participants$SCD[participants$SCD == 1] <- FALSE
participants$SCD[participants$SCD == 2] <- TRUE
participants$SCD[is.na(participants$SCD)] <- FALSE
### filter by age and if DWI is available ###
participants_over_55 <- participants %>% filter(age > 55)
#replace with location of your dwi participants.tsv
dwi_participants = read_tsv(file.path(data_dir, "imaging/dwi/participants.tsv")) %>%
select(participant_id) %>%
left_join(., participants, by='participant_id')
dwi_over_55 = dwi_participants %>% filter(age > 55)
write_tsv(dwi_over_55, "dwi_over_55.tsv")
### split dwi_over_55 into SCD and controls ###
scd = dwi_over_55 %>% filter(SCD == TRUE)
write_tsv(scd, "dwi_over_55_scd.tsv")
ctl = dwi_over_55 %>% filter(SCD == FALSE)
write_tsv(ctl, "dwi_over_55_ctl.tsv")
library(tidyverse)
dwi_over_55_scd_story = read.delim("dwi_over_55.tsv", tryLogical = FALSE) %>%
select(participant_id, SCD, age, sex, homeint_storyrecall_d)
View(dwi_over_55_scd_story)
View(dwi_over_55_scd_story)
design_matrix = read.delim("dwi_over_55.tsv", tryLogical = FALSE) %>%
mutate(EV1 = ifelse(scd == 0, 1, 0),
EV2 = ifelse(scd == 1, 1, 0)) %>%
rename(EV3 = age, EV4 = homeint_storyrecall_d) %>%
select(EV1, EV2, EV3, EV4)
design_matrix = read.delim("dwi_over_55.tsv", tryLogical = FALSE) %>%
mutate(EV1 = ifelse(SCD == 0, 1, 0),
EV2 = ifelse(SCD == 1, 1, 0)) %>%
rename(EV3 = age, EV4 = homeint_storyrecall_d) %>%
select(EV1, EV2, EV3, EV4)
View(design_matrix)
design_matrix <- read.delim("dwi_over_55.tsv", tryLogical = FALSE) %>%
mutate(EV1 = ifelse(SCD == 0, 1, 0),
EV2 = ifelse(SCD == 1, 1, 0)) %>%
rename(EV3 = age, EV4 = homeint_storyrecall_d) %>%
select(EV1, EV2, EV3, EV4)
#mean center covariates
design_matrix$EV3 <- scale(design_matrix$EV3, scale = FALSE)
design_matrix$EV4 <- scale(design_matrix$EV4, scale = FALSE)
#model 1: scd and story interaction
scd_story_mat <- design_matrix %>% select(EV1, EV2, EV4)
scd_story_mat$EV3 = scd_story_mat$EV4
#model 1: scd and story interaction
scd_story_mat <- design_matrix %>% select(EV1, EV2, EV4) %>%
mutate(EV3 = ifelse(EV1 == 1, EV4, 0),
EV4 = ifelse(EV1 == 0, EV4, 0)) %>%
select(order(colnames(.))) %>% #order columns alphabetically
unname(as.matrix(.))
#model 1: scd and story interaction
scd_story_mat <- design_matrix %>% select(EV1, EV2, EV4) %>%
mutate(EV3 = ifelse(EV1 == 1, EV4, 0),
EV4 = ifelse(EV1 == 0, EV4, 0)) #%>%
View(scd_story_mat)
#model 1: scd and story interaction
scd_story_mat <- design_matrix %>% select(EV1, EV2, EV4) %>%
mutate(EV3 = ifelse(EV1 == 1, EV4, 0),
EV4 = ifelse(EV1 == 0, EV4, 0)) %>%
select(order(colnames(.))) #%>% #order columns alphabetically
View(scd_story_mat)
#model 1: scd and story interaction
scd_story_mat <- design_matrix %>% select(EV1, EV2, EV4) %>%
mutate(EV3 = ifelse(EV1 == 1, EV4, 0),
EV4 = ifelse(EV1 == 0, EV4, 0)) %>%
select(order(colnames(.))) %>%
unname(as.matrix(.))
scd_story_mat <- unname(as.matrix(scd_story_mat))
write.table(scd_story_mat, file = "glm/scd_story_mat.txt", sep = "\t",
row.names = F, col.names = F)
dir.create("glm")
write.table(scd_story_mat, file = "glm/scd_story_mat.txt", sep = "\t",
row.names = F, col.names = F)
scd_story_con <- rbind(c(1,0), c(0,1), c(-1,0), c(0,-1))
#model 2: scd and age interaction
scd_age_mat <- design_matrix %>% select(EV1, EV2, EV3) %>%
mutate(EV3 = ifelse(EV1 == 1, EV3, 0),
EV4 = ifelse(EV1 == 0, EV3, 0))
View(scd_age_mat)
View(scd_story_mat)
#model 2: scd and age interaction
scd_age_mat <- design_matrix %>% select(EV1, EV2, EV3) %>%
mutate(EV4 = EV3) %>%
mutate(EV3 = ifelse(EV1 == 1, EV3, 0),
EV4 = ifelse(EV1 == 0, EV3, 0))
#model 2: scd and age interaction
scd_age_mat <- design_matrix %>% select(EV1, EV2, EV3) %>%
mutate(EV4 = ifelse(EV1 == 1, EV3, 0),
EV3 = ifelse(EV1 == 0, EV3, 0))
View(scd_age_mat)
scd_age_mat <- unname(as.matrix(scd_age_mat))
scd_age_con <- rbind(c(0,0,1,-1), c(0,0,-1,1))
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
mutate(EV1 = 1)
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3, EV3 = EV4) %>%
mutate(EV1 = 1)
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3) %>%
mutate(EV1 = 1)
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) #%>%
View(age_story_mat)
design_matrix <- read.delim("dwi_over_55.tsv", tryLogical = F) %>%
mutate(EV1 = ifelse(SCD == 0, 1, 0),
EV2 = ifelse(SCD == 1, 1, 0)) %>%
rename(EV3 = age, EV4 = homeint_storyrecall_d) %>%
select(EV1, EV2, EV3, EV4)
#mean center covariates
design_matrix$EV3 <- scale(design_matrix$EV3, scale = F)
design_matrix$EV4 <- scale(design_matrix$EV4, scale = F)
#model 1: scd and story interaction
scd_story_mat <- design_matrix %>% select(EV1, EV2, EV4) %>%
mutate(EV3 = ifelse(EV1 == 1, EV4, 0),
EV4 = ifelse(EV1 == 0, EV4, 0)) %>%
select(order(colnames(.))) #order columns alphabetically
scd_story_mat <- unname(as.matrix(scd_story_mat))
dir.create("glm")
write.table(scd_story_mat, file = "glm/scd_story_mat.txt", sep = "\t",
row.names = F, col.names = F)
scd_story_con <- rbind(c(0,0,1,-1), c(0,0,-1,1))
write.table(scd_story_con, file = "glm/scd_story_con.txt", sep = "\t",
row.names = F, col.names = F)
#model 2: scd and age interaction
scd_age_mat <- design_matrix %>% select(EV1, EV2, EV3) %>%
mutate(EV4 = ifelse(EV1 == 1, EV3, 0),
EV3 = ifelse(EV1 == 0, EV3, 0))
scd_age_mat <- unname(as.matrix(scd_age_mat))
write.table(scd_age_mat, file = "glm/scd_age_mat.txt", sep = "\t",
row.names = F, col.names = F)
scd_age_con <- rbind(c(0,0,1,-1), c(0,0,-1,1))
write.table(scd_age_con, file = "glm/scd_age_con.txt", sep = "\t",
row.names = F, col.names = F)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) #%>%
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4)
View(age_story_mat)
View(design_matrix)
design_matrix <- read.delim("dwi_over_55.tsv", tryLogical = F) %>%
mutate(EV1 = ifelse(SCD == 0, 1, 0),
EV2 = ifelse(SCD == 1, 1, 0)) %>%
rename(EV3 = age, EV4 = homeint_storyrecall_d) %>%
select(EV1, EV2, EV3, EV4)
View(design_matrix)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4)
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) #%>%
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3) %>%
mutate(EV1 = 1)
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3, EV3 = EV4) %>%
mutate(EV1 = 1)
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3, EV3 = EV4) %>%
mutate(EV1 = 1,
EV4 = EV2*EV3)
View(age_story_mat)
design_matrix <- read.delim("dwi_over_55.tsv", tryLogical = F) %>%
mutate(EV1 = ifelse(SCD == 0, 1, 0),
EV2 = ifelse(SCD == 1, 1, 0)) %>%
rename(EV3 = age, EV4 = homeint_storyrecall_d) %>%
select(EV1, EV2, EV3, EV4)
#mean center covariates
design_matrix$EV3 <- scale(design_matrix$EV3, scale = F)
design_matrix$EV4 <- scale(design_matrix$EV4, scale = F)
View(design_matrix)
#model 1: scd and story interaction
scd_story_mat <- design_matrix %>% select(EV1, EV2, EV4) %>%
mutate(EV3 = ifelse(EV1 == 1, EV4, 0),
EV4 = ifelse(EV1 == 0, EV4, 0)) %>%
select(order(colnames(.))) #order columns alphabetically
View(scd_story_mat)
View(design_matrix)
View(design_matrix)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3, EV3 = EV4) %>%
mutate(EV1 = 1,
EV4 = EV2*EV3)
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3, EV3 = EV4) %>%
mutate(EV1 = 1,
EV4 = EV2*EV3) %>%
select(order(colnames(.)))
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3, EV3 = EV4) %>%
mutate(EV1 = 1, #intercept
EV4 = EV2*EV3) %>% #interaction
select(order(colnames(.))) #order columns alphabetically
View(age_story_mat)
age_story_mat <- unname(as.matrix(age_story_mat))
age_story_con <- rbind(c(0,0,0,1), c(0,0,0,-1))
source("/Volumes/Research/lazarm03lab/labspace/AD/camcan995/derivatives/camcan_scd_dMRI_paper/10_fsl_glm_matrices.R", echo=TRUE)
system2
?system2
library(tidyverse)
library(officer)
?read_pptx
?layout_summary
View(age_story_con)
View(age_story_mat)
# model 3: age and story interaction
age_story_mat <- design_matrix %>% select(EV3, EV4) %>%
rename(EV2 = EV3, EV3 = EV4) %>%
mutate(EV1 = 1, #intercept
EV4 = EV2*EV3) %>% #interaction
select(order(colnames(.))) #order columns alphabetically
View(age_story_mat)
